<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>Free Scala 40 online</title>
    <link rel="stylesheet" href="scala40provacss.css" />
    <meta name="Description" content="Play free Scala40 card game online, no registration. Play against the computer. Choose between one, two or three opponents. Gioca Scala 40 gratis online senza registrazione">
    
</head>
<body>
<div class="main-container">
    <div id="sidebar-left" class="sidebar">
        <!-- Banner verranno inseriti qui da JS -->
    </div>

    <div id="campogioco">
        <div class="placeholder-text">
            campogioco<br>1024x750
        </div>
    </div>

    <div id="sidebar-right" class="sidebar">
        <!-- Banner verranno inseriti qui da JS -->
    </div>
</div>
    <script>
        function adjustLayout() {
            const gameWidth = 1024;
            const gameHeight = 750;
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;

            const campogioco = document.getElementById('campogioco');
            const sidebarLeft = document.getElementById('sidebar-left');
            const sidebarRight = document.getElementById('sidebar-right');

            // 1. Calcola il fattore di scala per il campogioco
            const scaleX = windowWidth / gameWidth;
            const scaleY = windowHeight / gameHeight;
            const scale = Math.min(scaleX, scaleY);

            // 2. Applica la scala e centra il campogioco
            campogioco.style.transform = `translate(-50%, -50%) scale(${scale})`;

            // 3. Calcola lo spazio rimanente per le sidebar
            const scaledGameWidth = gameWidth * scale;
            const sidebarWidth = (windowWidth - scaledGameWidth) / 2;

            // 4. Pulisci i banner precedenti e resetta la visualizzazione delle sidebar
            sidebarLeft.innerHTML = '';
            sidebarRight.innerHTML = '';
            sidebarLeft.style.display = 'none';
            sidebarRight.style.display = 'none';

            // Funzione di aiuto per creare un banner
            const createBanner = (width, height) => {
                const banner = document.createElement('div');
                banner.className = 'ad-banner';
                banner.style.width = `${width}px`;
                banner.style.height = `${height}px`;
                banner.innerHTML = `Banner<br>${width}x${height}`;
                return banner;
            };

            // Lista completa dei formati di annunci, ordinati per preferenza (larghezza > altezza)
            const allAdFormats = [
                { width: 300, height: 600 },
                { width: 300, height: 250 },
                { width: 300, height: 100 }, // Added: Large Mobile Banner or Rectangle
                { width: 160, height: 600 },
                { width: 160, height: 250 },
                { width: 160, height: 160 },
                { width: 120, height: 600 }, // Added: Skyscraper
                { width: 120, height: 240 }  // Added: from original HTML, but moved here
            ];

            // Funzione per popolare una sidebar con i banner che ci stanno
            const populateSidebar = (sidebar, availableWidth) => {
                let currentAvailableHeight = windowHeight;
                const verticalGap = 15;

                // 1. Determina la "famiglia" di banner da usare in base alla larghezza disponibile
                let bannerWidthFamily = 0;
                if (availableWidth >= 300) {
                    bannerWidthFamily = 300;
                } else if (availableWidth >= 160) {
                    bannerWidthFamily = 160;
                } else if (availableWidth >= 120) {
                    bannerWidthFamily = 120;
                }

                if (bannerWidthFamily > 0) {
                    // 2. Filtra i formati per la famiglia di larghezza scelta
                    const applicableFormats = allAdFormats.filter(f => f.width === bannerWidthFamily);

                    // 3. Itera attraverso la lista filtrata e piazza i banner
                    applicableFormats.forEach(format => {
                        const isFirstBannerInSidebar = sidebar.childElementCount === 0;
                        const requiredGapForThisBanner = isFirstBannerInSidebar ? 0 : verticalGap;

                        // Caso 1: C'è spazio per il banner E per il gap richiesto (se non è il primo)
                        if (currentAvailableHeight >= (format.height + requiredGapForThisBanner)) {
                            const banner = createBanner(format.width, format.height);
                            if (!isFirstBannerInSidebar) {
                                banner.style.marginTop = `${verticalGap}px`;
                            }
                            sidebar.appendChild(banner);
                            currentAvailableHeight -= (format.height + requiredGapForThisBanner);
                        }
                        // Caso 2: Non c'è spazio per il banner + gap, ma c'è spazio solo per il banner (e non è il primo)
                        else if (!isFirstBannerInSidebar && currentAvailableHeight >= format.height) {
                            const banner = createBanner(format.width, format.height);
                            // Non aggiungiamo margin-top, userà lo spazio rimanente
                            sidebar.appendChild(banner);
                            currentAvailableHeight -= format.height;
                        }
                        // Altrimenti, il banner non ci sta affatto
                    });
                }
            };
            
            // 5. Popola le sidebar se c'è abbastanza spazio
            // La soglia minima è la larghezza del banner più piccolo che vogliamo mostrare
            if (sidebarWidth >= 120) { // Changed from 160 to 120 as new minimum
                sidebarLeft.style.width = sidebarWidth + 'px';
                sidebarRight.style.width = sidebarWidth + 'px';
                sidebarLeft.style.display = 'flex';
                sidebarRight.style.display = 'flex';

                populateSidebar(sidebarLeft, sidebarWidth);
                populateSidebar(sidebarRight, sidebarWidth);
            }
        }

        // Esegui la funzione al caricamento e al ridimensionamento
        window.addEventListener('load', adjustLayout);
        window.addEventListener('resize', adjustLayout);
    </script>

</body>
</html>